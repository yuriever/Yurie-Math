(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    100937,       2628]
NotebookOptionsPosition[     88179,       2382]
NotebookOutlinePosition[     88627,       2400]
CellTagsIndexPosition[     88584,       2397]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "Yurie`Math`"}]], "Code",
 CellLabel->"In[23]:=",ExpressionUUID->"0e356f6d-bf98-4447-9a33-73191d6da219"],

Cell[CellGroupData[{

Cell["label", "Subsection",ExpressionUUID->"32cd0893-7082-4e2c-8e01-d54bc5655161"],

Cell[CellGroupData[{

Cell["Basic", "Subsubsection",ExpressionUUID->"a25e9918-8c52-4afd-9cee-0f3921e2eaea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"label", "[", 
  RowBox[{"x", ",", "1", ",", "Symbol"}], "]"}]], "Code",
 CellLabel->"In[24]:=",ExpressionUUID->"4e42c48b-b7ff-4871-8896-894951ca0da3"],

Cell[BoxData["x1"], "Output",
 CellLabel->"Out[24]=",ExpressionUUID->"20acb146-b4d2-4da4-b0a4-40cbfd624312"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"label", "[", 
   RowBox[{
    RowBox[{"x", "|", "y"}], ",", "1", ",", "Symbol"}], "]"}], "}"}]], "Code",
 CellLabel->"In[25]:=",ExpressionUUID->"78ae4323-7205-42ae-9c14-5eebcdff779d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1"}], "}"}]], "Output",
 CellLabel->"Out[25]=",ExpressionUUID->"cffa726e-ad5d-432c-8c00-086e125a7241"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Outer", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "c", ",", "\"\<c\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[26]:=",ExpressionUUID->"8b92569e-aa83-4c8d-822c-670405c10530"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc", ",", 
     RowBox[{"x", "[", "c", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "c"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc", ",", 
     RowBox[{"x", "[", "\<\"c\"\>", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "\<\"c\"\>"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[26]=",ExpressionUUID->"e576407e-bfcf-45c0-b7de-966ae7af5b8e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pattern variable", "Subsubsection",ExpressionUUID->"0d5baec8-7cab-42a6-8e3d-e75b700a60e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"label", "[", 
   RowBox[{
    RowBox[{"x_", "|", "y_"}], ",", "1", ",", "Symbol"}], "]"}], 
  "}"}]], "Code",
 CellLabel->"In[27]:=",ExpressionUUID->"f80496c2-aa95-436f-ae61-432d81e76874"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1_", ",", "y1_"}], "}"}]], "Output",
 CellLabel->"Out[27]=",ExpressionUUID->"40fc7ac9-99cb-4bbc-aa18-3b42e054fcb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Outer", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x_", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "c", ",", "\"\<c\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[28]:=",ExpressionUUID->"b467c368-ecc2-4efd-9446-fc6cc106a2ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1_", ",", 
     RowBox[{"x_", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x_", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc_", ",", 
     RowBox[{"x_", "[", "c", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x_", ",", "c"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc_", ",", 
     RowBox[{"x_", "[", "\<\"c\"\>", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x_", ",", "\<\"c\"\>"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[28]=",ExpressionUUID->"dc2cee1b-fec7-4005-9560-e532feed4351"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"label", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y__", ",", "z___", ",", "w_List", ",", 
      RowBox[{"u", ":", "pat"}]}], "}"}], ",", "1", ",", "Symbol"}], "]"}], 
  "}"}]], "Code",
 CellLabel->"In[29]:=",ExpressionUUID->"d23ef260-f63f-4173-96c7-f9bb71949c75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1_", ",", "y1__", ",", "z1___", ",", "w1_List", ",", 
   RowBox[{"u1", ":", "pat"}]}], "}"}]], "Output",
 CellLabel->"Out[29]=",ExpressionUUID->"2c6a124a-b3e2-4a47-941d-cfb987fcc1ff"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol with format definition", "Subsubsection",ExpressionUUID->"98bf7fef-f2ef-421a-9686-3e305100a7ab"],

Cell[BoxData[
 RowBox[{"ToExpression", "[", "\"\<Format[phat]:=OverHat[p]\>\"", 
  "]"}]], "Code",
 CellLabel->"In[30]:=",ExpressionUUID->"48d3e96f-b21d-497b-8fb2-d6805447f044"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"label", "[", 
   RowBox[{"phat", ",", "1"}], "]"}], "//", "FullForm"}]], "Code",
 CellLabel->"In[31]:=",ExpressionUUID->"12712ef7-07b7-4ca1-a834-c4fbf56ac80a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"phat", "[", "1", "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellLabel->
  "Out[31]//FullForm=",ExpressionUUID->"7166557d-4800-4557-a0eb-a8c58288f767"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phat1", "//", 
   RowBox[{"labelSplit", "[", "phat", "]"}]}], "//", "FullForm"}]], "Code",
 CellLabel->"In[32]:=",ExpressionUUID->"edd98575-2e24-4843-9e80-496bf657ea01"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"phat", "[", "1", "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellLabel->
  "Out[32]//FullForm=",ExpressionUUID->"5cb684cb-3bf6-4411-9732-40b3a7337ace"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "phat", "]"}]], "Code",
 CellLabel->"In[33]:=",ExpressionUUID->"8d4e7cee-65fe-4a6b-9a0e-1b2b222715db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["List argument", "Subsubsection",ExpressionUUID->"d438ec4f-6b36-4e53-b771-9d8c6d708e70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labels", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",\
ExpressionUUID->"513deca4-7861-464d-9a47-f32ca9804f1e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[20]=",ExpressionUUID->"f01ac0b1-e7d9-4bf4-ac18-d9c88bb30ae8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labels", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", 
      RowBox[{"{", "1", "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",\
ExpressionUUID->"c64f97c7-e33d-4464-bba3-c4e897e7bc5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[21]=",ExpressionUUID->"9c2de479-d70f-48a5-823c-ac1fb0cf3b35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labels", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",\
ExpressionUUID->"cbf59a24-eece-4e20-a9ff-6293e5f25f2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"y", "[", "2", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "2"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[22]=",ExpressionUUID->"9450140f-ba86-4150-adb6-2bb4727964a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Invalid pattern", "Subsubsection",ExpressionUUID->"e9c39986-ef05-438a-972d-797055f58a94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[26]:=",ExpressionUUID->"b26ae426-9c67-47d4-9ade-aa81276140cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["x", HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"-", "1"}], HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {$CellContext`x, -1}, "Var" -> $CellContext`x, 
      "Label" -> -1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"x", "[", 
    RowBox[{"-", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[26]=",ExpressionUUID->"bf7fe9f4-c07b-43e1-9c71-8e4038d2eb9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{
      RowBox[{"x", "[", "]"}], ",", "1", ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[27]:=",ExpressionUUID->"cbaf5a6d-c05d-40d4-937e-85d65e5c965f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"x", "[", "]"}], HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["1", HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {
        $CellContext`x[], 1}, "Var" -> $CellContext`x[], "Label" -> 1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{
    RowBox[{"x", "[", "]"}], "[", "1", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{
     RowBox[{"x", "[", "]"}], ",", "1"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[27]=",ExpressionUUID->"18c6fa3e-4944-47aa-8a86-8b9ce6956c09"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["labelAt", "Subsection",ExpressionUUID->"028eeb3b-8b08-4bf7-acf8-95d6c1414593"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"1", "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[28]:=",ExpressionUUID->"a4d903e8-cc67-4bcf-b763-c2477a3e89bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{"x1", "\[Rule]", "1"}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"head", "[", 
       RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[28]=",ExpressionUUID->"60b54247-0e92-4a3a-a7c9-f4bbf79bb779"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "->", "1"}], ",", "#"}], "]"}], "&"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[29]:=",ExpressionUUID->"24cecbbf-91e8-4faf-8b73-43aa3d5bd14d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[29]=",ExpressionUUID->"d478fc0c-1f09-4f46-8858-5fe91533e259"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[30]:=",ExpressionUUID->"52ce40f3-17ab-413d-bda8-86ecc00090f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "2"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "2"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "2"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[30]=",ExpressionUUID->"044a1e3c-da71-4d08-a658-b7969eb051ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"1", "|", "2"}], "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[31]:=",ExpressionUUID->"f028ccc4-8fd6-4fa0-8f3c-bbdb74fcb76c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[31]=",ExpressionUUID->"9c4a9380-1e6f-4a94-a01d-7e7973df667e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"1", "->", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "->", "4"}], ",", 
      RowBox[{
       RowBox[{"6", "|", "7"}], "->", "5"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[32]:=",ExpressionUUID->"02ed57f9-11f4-43d6-9d8c-e8df6c42c06c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "2"}], ",", 
      RowBox[{"x3", "\[Rule]", "3"}], ",", 
      RowBox[{"x4", "\[Rule]", "4"}], ",", 
      RowBox[{"x5", "\[Rule]", "4"}], ",", 
      RowBox[{"x6", "\[Rule]", "5"}], ",", 
      RowBox[{"x7", "\[Rule]", "5"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "3", "]"}], "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "4", "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "6", "]"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "7", "]"}], "\[Rule]", "5"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "3"}], "]"}], "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "4"}], "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "5"}], "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "6"}], "]"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "7"}], "]"}], "\[Rule]", "5"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[32]=",ExpressionUUID->"e0a07acc-e93c-4561-800e-e222c6577547"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pattern variable", "Subsubsection",ExpressionUUID->"c4e7b34d-b93f-4a68-a24e-3daf221827fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"_", "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[33]:=",ExpressionUUID->"f573d282-753b-4eae-acac-ce228f4ba463"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "_", "]"}], "\[Rule]", "1"}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"head", "[", 
       RowBox[{"x", ",", "_"}], "]"}], "\[Rule]", "1"}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[33]=",ExpressionUUID->"2e367b80-e52a-475a-b7b0-5b17f49b4db5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"2", "->", "2"}], ",", 
      RowBox[{"_", "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[34]:=",ExpressionUUID->"9b799d2b-84d2-4465-b0ff-dc5819e06e26"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "_", "]"}], "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "_"}], "]"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[34]=",ExpressionUUID->"0c31d117-ffe9-4090-8cde-f13cc8a76bd8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["List argument", "Subsubsection",ExpressionUUID->"e860ef94-2eeb-4713-93a7-691bd2cf9a1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "->", "a"}], ",", "#"}], "]"}], "&"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[35]:=",ExpressionUUID->"91565f78-c1e4-4fa5-a797-dfce0d714a77"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "a"}], ",", 
      RowBox[{"x2", "\[Rule]", "a"}], ",", 
      RowBox[{"y1", "\[Rule]", "a"}], ",", 
      RowBox[{"y2", "\[Rule]", "a"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "2", "]"}], "\[Rule]", "a"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "2"}], "]"}], "\[Rule]", "a"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[35]=",ExpressionUUID->"cfb86cee-aa40-43f2-900b-d192688ac8ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", 
      RowBox[{"1", "->", "a"}], ",", 
      RowBox[{"2", "->", "b"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",\
ExpressionUUID->"368ac821-98da-4903-9ac1-140372720c7b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "a"}], ",", 
      RowBox[{"x2", "\[Rule]", "b"}], ",", 
      RowBox[{"y1", "\[Rule]", "a"}], ",", 
      RowBox[{"y2", "\[Rule]", "b"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "b"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "2", "]"}], "\[Rule]", "b"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "b"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "2"}], "]"}], "\[Rule]", "b"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[36]=",ExpressionUUID->"f20866ac-0b3c-4f76-8081-a0044b3fc1f5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Invalid pattern", "Subsubsection",ExpressionUUID->"9ac4795c-9635-4c2d-b84d-0887910e49ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelAt", "[", 
  RowBox[{"x", ",", 
   RowBox[{"_", "->", "1"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->"In[37]:=",ExpressionUUID->"3ac1387d-fe43-468e-82e6-1dce558e0579"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      TagBox["Failure",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               FrameBox[
                StyleBox["\"\[WarningSign]\"", 
                 Directive["Message", 35], StripOnInput -> False], 
                ContentPadding -> False, FrameStyle -> None, 
                FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}, {
                  TagBox[
                   GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               FrameBox[
                StyleBox["\"\[WarningSign]\"", 
                 Directive["Message", 35], StripOnInput -> False], 
                ContentPadding -> False, FrameStyle -> None, 
                FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}, {
                  TagBox[
                   GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}, {
                  RowBox[{
                    TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["x", HoldForm], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["_", HoldForm], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     Failure[
     "InvalidSymbol", <|
      "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
       "MessageParameters" -> {$CellContext`x, 
         Blank[]}, "Var" -> $CellContext`x, "Label" -> Blank[]|>],
     Editable->False,
     SelectWithContents->True,
     Selectable->False], "\[Rule]", "1"}], "}"}], "]"}]], "Output",
 CellLabel->"Out[37]=",ExpressionUUID->"82861d19-292d-4292-a06e-9413f90edb9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelAt", "[", 
  RowBox[{"x", ",", 
   RowBox[{"2", "->", "2"}], ",", 
   RowBox[{"_", "->", "1"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->"In[38]:=",ExpressionUUID->"5ef27613-20a7-4728-8cda-e2d3ddb37285"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x2", "\[Rule]", "2"}], ",", 
    RowBox[{
     InterpretationBox[
      RowBox[{
       TagBox["Failure",
        "SummaryHead"], "[", 
       DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
        "Ready"}, 
        TemplateBox[{
          PaneSelectorBox[{False -> GridBox[{{
                PaneBox[
                 ButtonBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "FEBitmaps", "SummaryBoxOpener"]], 
                  ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                  None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                  "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                 Dynamic[{
                   Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                FrameBox[
                 StyleBox["\"\[WarningSign]\"", 
                  Directive["Message", 35], StripOnInput -> False], 
                 ContentPadding -> False, FrameStyle -> None, 
                 FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
                GridBox[{{
                   TagBox[
                    GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}, {
                   TagBox[
                    GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                 False, GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                 BaseStyle -> {
                  ShowStringCharacters -> False, NumberMarks -> False, 
                   PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
              GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
              AutoDelete -> False, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              BaselinePosition -> {1, 1}], True -> GridBox[{{
                PaneBox[
                 ButtonBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "FEBitmaps", "SummaryBoxCloser"]], 
                  ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                  None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                  "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                 Dynamic[{
                   Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                FrameBox[
                 StyleBox["\"\[WarningSign]\"", 
                  Directive["Message", 35], StripOnInput -> False], 
                 ContentPadding -> False, FrameStyle -> None, 
                 FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
                GridBox[{{
                   TagBox[
                    GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}, {
                   TagBox[
                    GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}, {
                   RowBox[{
                    TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["x", HoldForm], "SummaryItem"]}]}, {
                   RowBox[{
                    TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["_", HoldForm], "SummaryItem"]}]}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                 False, GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                 BaseStyle -> {
                  ShowStringCharacters -> False, NumberMarks -> False, 
                   PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
              GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
              AutoDelete -> False, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              BaselinePosition -> {1, 1}]}, 
           Dynamic[Typeset`open$$], ImageSize -> Automatic]},
         "SummaryPanel"],
        DynamicModuleValues:>{}], "]"}],
      Failure[
      "InvalidSymbol", <|
       "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
        "MessageParameters" -> {$CellContext`x, 
          Blank[]}, "Var" -> $CellContext`x, "Label" -> Blank[]|>],
      Editable->False,
      SelectWithContents->True,
      Selectable->False], "\[Rule]", "1"}]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[38]=",ExpressionUUID->"8f9e6b69-c9c1-4d87-a220-1ad598f75343"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["labelConvert", "Subsection",ExpressionUUID->"9de0ba20-012f-4a24-be34-b18b931fc5df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x1", "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Symbol", "->", "Function"}]}], "]"}]}]], "Code",
 CellLabel->"In[39]:=",ExpressionUUID->"1cc55161-dd94-4607-a7fe-2c0a770da0bc"],

Cell[BoxData[
 RowBox[{"x", "[", "1", "]"}]], "Output",
 CellLabel->"Out[39]=",ExpressionUUID->"8bde1255-ff4a-4aa6-8279-cf1e6c921e19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x1", "+", "y2"}], "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{
    RowBox[{"x", "|", "y"}], ",", 
    RowBox[{"Symbol", "->", "Function"}]}], "]"}]}]], "Code",
 CellLabel->"In[40]:=",ExpressionUUID->"0ea94ef0-f603-491a-b6b1-efd658aba4f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "1", "]"}], "+", 
  RowBox[{"y", "[", "2", "]"}]}]], "Output",
 CellLabel->"Out[40]=",ExpressionUUID->"f588c388-6bf8-41aa-a48d-39c9ebad09af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Outer", "[", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "->", 
      RowBox[{
       RowBox[{"labelConvert", "[", 
        RowBox[{
         RowBox[{"x", "|", "y"}], ",", 
         RowBox[{"#1", "->", "#2"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]}], "&"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "\n", "]"}], "//",
   "MatrixForm"}]], "Code",ExpressionUUID->"32bbb5c4-a189-46b6-a183-\
10df64297350"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Symbol", ",", "Symbol"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Symbol", ",", "Function"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Symbol", ",", "head"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Function", ",", "Symbol"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x1", ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Function", ",", "Function"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Function", ",", "head"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "Symbol"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", "x1"}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "Function"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "head"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[41]//MatrixForm=",ExpressionUUID->"67f85448-a836-428a-87dd-\
5637b83e51b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"labelJoin", "[", 
      RowBox[{
       RowBox[{"x", "|", "y"}], ",", "#1"}], "]"}], "@", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], "&"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "\n", 
  "]"}]], "Code",ExpressionUUID->"6b947232-b785-4c12-85be-cc150d459252"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x1", ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", "x1"}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[42]=",ExpressionUUID->"6ad41780-d24c-4c05-aa1a-a9e0bebea7d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"labelSplit", "[", 
      RowBox[{
       RowBox[{"x", "|", "y"}], ",", "#1"}], "]"}], "@", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], "&"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "\n", 
  "]"}]], "Code",ExpressionUUID->"b92c6845-d723-4591-bc27-9a8af490902c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}], ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[43]=",ExpressionUUID->"4e2e3d47-b744-441b-81fb-acfa85b5e756"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error handling", "Subsubsection",ExpressionUUID->"68f8edbc-8d33-4f5a-a6ea-480f520e124b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"labelConvert", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Symbol", "->", "Function"}], ",", 
    RowBox[{"\"\<LabelType\>\"", "->", "\"\<UndefinedType\>\""}]}], "]"}], "[",
   "x1", "]"}]], "Code",
 CellLabel->"In[44]:=",ExpressionUUID->"4e302271-e6ff-4028-9784-3edbfc1b33ef"],

Cell[BoxData[
 TemplateBox[{
  "label", "UndefinedType", 
   "\"the label type \\!\\(\\*RowBox[{\\\"\\\\\\\"UndefinedType\\\\\\\"\\\"}]\
\\) is undefined, and should be one of the \
followings:\\n\\!\\(\\*TagBox[GridBox[{{\\\"\\\\\\\"PositiveInteger\\\\\\\"\\\
\"}, {\\\"\\\\\\\"PositiveIntegerOrSingleLetter\\\\\\\"\\\"}, \
{\\\"\\\\\\\"PositiveIntegerOrGreekLetter\\\\\\\"\\\"}, \
{\\\"\\\\\\\"NaturalNumber\\\\\\\"\\\"}, \
{\\\"\\\\\\\"NaturalNumberOrSingleLetter\\\\\\\"\\\"}, \
{\\\"\\\\\\\"NaturalNumberOrGreekLetter\\\\\\\"\\\"}}, Rule[GridBoxAlignment, \
List[Rule[\\\"Columns\\\", List[List[Left]]]]], Rule[DefaultBaseStyle, \
\\\"Column\\\"], Rule[GridBoxItemSize, List[Rule[\\\"Columns\\\", \
List[List[Automatic]]], Rule[\\\"Rows\\\", List[List[Automatic]]]]]], \
\\\"Column\\\"]\\).\"", 2, 44, 1, 24712720699807233664, "Local", 
   "Yurie`Math`label"},
  "MessageTemplate2",
  BaseStyle->"MSG"]], "Message",
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"73aab133-677a-4196-b5b6-fe3779e50293"],

Cell[BoxData["x1"], "Output",
 CellLabel->"Out[44]=",ExpressionUUID->"ff7ce4ff-cbca-41d7-94c4-3783ec5ab7e1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Label type", "Subsubsection",ExpressionUUID->"c8932fc5-0188-4aa3-8766-9dff6278a2f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"labelConvert", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Symbol", "->", "Function"}], ",", 
    RowBox[{"\"\<LabelType\>\"", "->", "\"\<PositiveInteger\>\""}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x0"}], "}"}], "]"}]], "Code",
 CellLabel->"In[45]:=",ExpressionUUID->"81565a34-a636-4a66-aae6-045fc23a83aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], ",", "x0"}], "}"}]], "Output",
 CellLabel->"Out[45]=",ExpressionUUID->"61fc097b-1392-4a93-8c20-2b07d385c8b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zb1", "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{
    RowBox[{"z", "|", "zb"}], ",", 
    RowBox[{"Symbol", "->", "Function"}], ",", 
    RowBox[{"\"\<LabelType\>\"", "->", "\"\<PositiveInteger\>\""}]}], 
   "]"}]}]], "Code",
 CellLabel->"In[46]:=",ExpressionUUID->"a71d01c9-3cdf-4747-a17c-d8e282ceaf29"],

Cell[BoxData[
 RowBox[{"zb", "[", "1", "]"}]], "Output",
 CellLabel->"Out[46]=",ExpressionUUID->"47c7e856-5cc0-44e0-95a5-e3fedb8cac94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zb1", "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{
    RowBox[{"z", "|", "zb"}], ",", 
    RowBox[{"Symbol", "->", "Function"}]}], "]"}]}]], "Code",
 CellLabel->"In[47]:=",ExpressionUUID->"9d0fe427-a839-47ba-a146-5010b33a6cce"],

Cell[BoxData[
 RowBox[{"z", "[", "b1", "]"}]], "Output",
 CellLabel->"Out[47]=",ExpressionUUID->"e560c2fc-879e-4ca9-96c4-84813709ae74"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Held expression", "Subsubsection",ExpressionUUID->"92d2a3f2-b661-4fba-a0db-d9e19a21eaeb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hold", "[", 
   RowBox[{
    RowBox[{"x", "[", "1", "]"}], "+", 
    RowBox[{"x", "[", "2", "]"}]}], "]"}], "//", 
  RowBox[{"labelJoin", "[", "x", "]"}]}]], "Code",
 CellLabel->"In[48]:=",ExpressionUUID->"baa990df-8787-4b5d-81ef-ec49ac0cae5d"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"x1", "+", "x2"}], "]"}]], "Output",
 CellLabel->"Out[48]=",ExpressionUUID->"8a20487b-6669-4ffb-be72-6fca1e935dc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldComplete", "[", 
   RowBox[{"x", "[", "1", "]"}], "]"}], "//", 
  RowBox[{"labelJoin", "[", "x", "]"}]}]], "Code",
 CellLabel->"In[49]:=",ExpressionUUID->"c56fd884-dad4-4888-b17b-f81e5e853a07"],

Cell[BoxData[
 RowBox[{"HoldComplete", "[", "x1", "]"}]], "Output",
 CellLabel->"Out[49]=",ExpressionUUID->"28398937-f8ca-4fb7-a9ff-35ab1f5bbf1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hold", "[", 
   RowBox[{"x1", "+", "x2"}], "]"}], "//", 
  RowBox[{"labelSplit", "[", "x", "]"}]}]], "Code",
 CellLabel->"In[50]:=",ExpressionUUID->"3affcefd-55f2-41c9-bb30-11e5a6ef989c"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], "+", 
   RowBox[{"x", "[", "2", "]"}]}], "]"}]], "Output",
 CellLabel->"Out[50]=",ExpressionUUID->"de87153a-0dfa-4311-bf3e-100ba5b67768"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldComplete", "[", "x1", "]"}], "//", 
  RowBox[{"labelSplit", "[", "x", "]"}]}]], "Code",
 CellLabel->"In[51]:=",ExpressionUUID->"8b5c94ac-2630-47bb-b361-e8f48fb77874"],

Cell[BoxData[
 RowBox[{"HoldComplete", "[", 
  RowBox[{"x", "[", "1", "]"}], "]"}]], "Output",
 CellLabel->"Out[51]=",ExpressionUUID->"4ed3c217-f3a5-4a7a-90e5-e68a0167de7d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["labelTo", "Subsection",ExpressionUUID->"a72d23ba-3074-43e4-8ff4-5681f0f2b915"],

Cell[CellGroupData[{

Cell["List argument", "Subsubsection",ExpressionUUID->"9bd34e72-643e-45ad-b8a9-f6fb752e02f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToZero", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[52]:=",ExpressionUUID->"068ae918-9902-4bf9-8d87-f1fe62a4d3b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", "0"}], ",", 
      RowBox[{"z2", "\[Rule]", "0"}], ",", 
      RowBox[{"zb1", "\[Rule]", "0"}], ",", 
      RowBox[{"zb2", "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[52]=",ExpressionUUID->"5b0c5470-1bab-4a5f-9a29-0b3e3716b2d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToEqual", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[53]:=",ExpressionUUID->"8d2eea1f-dd82-4d2d-a669-4f6df8484a6b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", "z2"}], ",", 
      RowBox[{"zb1", "\[Rule]", "zb2"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"z", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"zb", "[", "2", "]"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "2"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "2"}], "]"}]}]}], "}"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[53]=",ExpressionUUID->"05bda7d1-0151-47f6-a76b-828764050fcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToDiff", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[54]:=",ExpressionUUID->"e431a95e-dc21-4f74-a710-aa3b2e1018ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", 
       RowBox[{"z12", "+", "z2"}]}], ",", 
      RowBox[{"zb1", "\[Rule]", 
       RowBox[{"zb12", "+", "zb2"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], "+", 
        RowBox[{"z", "[", "\<\"12\"\>", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"zb", "[", "2", "]"}], "+", 
        RowBox[{"zb", "[", "\<\"12\"\>", "]"}]}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "2"}], "]"}], "+", 
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "\<\"12\"\>"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "2"}], "]"}], "+", 
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "\<\"12\"\>"}], "]"}]}]}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[54]=",ExpressionUUID->"9b62e202-d0be-4a7c-8fb9-bb16602666e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToDiffZero", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[55]:=",ExpressionUUID->"8f455cc3-ef15-4283-bd0a-acfb271849f1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", "z12"}], ",", 
      RowBox[{"z2", "\[Rule]", "0"}], ",", 
      RowBox[{"zb1", "\[Rule]", "zb12"}], ",", 
      RowBox[{"zb2", "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"z", "[", "\<\"12\"\>", "]"}]}], ",", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"zb", "[", "\<\"12\"\>", "]"}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "\<\"12\"\>"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "\<\"12\"\>"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[55]=",ExpressionUUID->"e479e194-1dcf-4be7-a8b2-f330cbe3347c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToDiffBack", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[56]:=",ExpressionUUID->"a2d609d3-84a4-4a28-bc8e-728cbca9db16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z12", "\[Rule]", 
       RowBox[{"z1", "-", "z2"}]}], ",", 
      RowBox[{"zb12", "\[Rule]", 
       RowBox[{"zb1", "-", "zb2"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "\<\"12\"\>", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], "-", 
        RowBox[{"z", "[", "2", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "\<\"12\"\>", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"zb", "[", "1", "]"}], "-", 
        RowBox[{"zb", "[", "2", "]"}]}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "\<\"12\"\>"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "1"}], "]"}], "-", 
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "2"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "\<\"12\"\>"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "1"}], "]"}], "-", 
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "2"}], "]"}]}]}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[56]=",ExpressionUUID->"fbca8e39-0022-4770-a0e3-29376083af32"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error handling", "Subsubsection",ExpressionUUID->"e84dfe81-09b4-4c51-b328-279b92b70f7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelToZero", "[", 
  RowBox[{
   RowBox[{"z", "[", "]"}], ",", 
   RowBox[{"{", "1", "}"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->"In[57]:=",ExpressionUUID->"34252dc3-e7ac-4f44-9be6-ad0210774f51"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"z\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"z\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"z", "[", "]"}], HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["1", HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {
        $CellContext`z[], 1}, "Var" -> $CellContext`z[], "Label" -> 1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], "\[Rule]", "0"}], "]"}]], "Output",
 CellLabel->"Out[57]=",ExpressionUUID->"c199f36f-2b3e-4fd8-b117-9e67edb9de8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelToZero", "[", 
  RowBox[{"z", ",", 
   RowBox[{"{", 
    RowBox[{"-", "1"}], "}"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->"In[58]:=",ExpressionUUID->"2e8511d3-2509-4f86-85a3-2d7ec01ae78b"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"z\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"z\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["z", HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"-", "1"}], HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {$CellContext`z, -1}, "Var" -> $CellContext`z, 
      "Label" -> -1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], "\[Rule]", "0"}], "]"}]], "Output",
 CellLabel->"Out[58]=",ExpressionUUID->"5e4a1967-6570-4d91-adb6-47762e34900a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Editable->True,
WindowSize->{1280, 1387},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Yurie.nb",
ExpressionUUID->"308c67c5-16d8-4b33-bbfe-12a01797f898"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 133, 2, 65, "Code",ExpressionUUID->"0e356f6d-bf98-4447-9a33-73191d6da219"],
Cell[CellGroupData[{
Cell[712, 26, 82, 0, 66, "Subsection",ExpressionUUID->"32cd0893-7082-4e2c-8e01-d54bc5655161"],
Cell[CellGroupData[{
Cell[819, 30, 85, 0, 54, "Subsubsection",ExpressionUUID->"a25e9918-8c52-4afd-9cee-0f3921e2eaea"],
Cell[CellGroupData[{
Cell[929, 34, 174, 3, 65, "Code",ExpressionUUID->"4e42c48b-b7ff-4871-8896-894951ca0da3"],
Cell[1106, 39, 108, 1, 41, "Output",ExpressionUUID->"20acb146-b4d2-4da4-b0a4-40cbfd624312"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1251, 45, 223, 5, 65, "Code",ExpressionUUID->"78ae4323-7205-42ae-9c14-5eebcdff779d"],
Cell[1477, 52, 154, 3, 41, "Output",ExpressionUUID->"cffa726e-ad5d-432c-8c00-086e125a7241"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1668, 60, 401, 10, 65, "Code",ExpressionUUID->"8b92569e-aa83-4c8d-822c-670405c10530"],
Cell[2072, 72, 634, 18, 41, "Output",ExpressionUUID->"e576407e-bfcf-45c0-b7de-966ae7af5b8e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2755, 96, 96, 0, 54, "Subsubsection",ExpressionUUID->"0d5baec8-7cab-42a6-8e3d-e75b700a60e8"],
Cell[CellGroupData[{
Cell[2876, 100, 228, 6, 65, "Code",ExpressionUUID->"f80496c2-aa95-436f-ae61-432d81e76874"],
Cell[3107, 108, 156, 3, 41, "Output",ExpressionUUID->"40fc7ac9-99cb-4bbc-aa18-3b42e054fcb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3300, 116, 402, 10, 65, "Code",ExpressionUUID->"b467c368-ecc2-4efd-9446-fc6cc106a2ae"],
Cell[3705, 128, 643, 18, 41, "Output",ExpressionUUID->"dc2cee1b-fec7-4005-9560-e532feed4351"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4385, 151, 322, 8, 65, "Code",ExpressionUUID->"d23ef260-f63f-4173-96c7-f9bb71949c75"],
Cell[4710, 161, 224, 4, 41, "Output",ExpressionUUID->"2c6a124a-b3e2-4a47-941d-cfb987fcc1ff"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4983, 171, 109, 0, 54, "Subsubsection",ExpressionUUID->"98bf7fef-f2ef-421a-9686-3e305100a7ab"],
Cell[5095, 173, 177, 3, 65, "Code",ExpressionUUID->"48d3e96f-b21d-497b-8fb2-d6805447f044"],
Cell[CellGroupData[{
Cell[5297, 180, 194, 4, 65, "Code",ExpressionUUID->"12712ef7-07b7-4ca1-a834-c4fbf56ac80a"],
Cell[5494, 186, 273, 9, 41, "Output",ExpressionUUID->"7166557d-4800-4557-a0eb-a8c58288f767"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5804, 200, 204, 4, 65, "Code",ExpressionUUID->"edd98575-2e24-4843-9e80-496bf657ea01"],
Cell[6011, 206, 273, 9, 41, "Output",ExpressionUUID->"5cb684cb-3bf6-4411-9732-40b3a7337ace"]
}, Open  ]],
Cell[6299, 218, 142, 2, 65, "Code",ExpressionUUID->"8d4e7cee-65fe-4a6b-9a0e-1b2b222715db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6478, 225, 93, 0, 54, "Subsubsection",ExpressionUUID->"d438ec4f-6b36-4e53-b771-9d8c6d708e70"],
Cell[CellGroupData[{
Cell[6596, 229, 354, 10, 65, "Code",ExpressionUUID->"513deca4-7861-464d-9a47-f32ca9804f1e"],
Cell[6953, 241, 366, 9, 41, "Output",ExpressionUUID->"f01ac0b1-e7d9-4bf4-ac18-d9c88bb30ae8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7356, 255, 353, 10, 65, "Code",ExpressionUUID->"c64f97c7-e33d-4464-bba3-c4e897e7bc5b"],
Cell[7712, 267, 366, 9, 41, "Output",ExpressionUUID->"9c2de479-d70f-48a5-823c-ac1fb0cf3b35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8115, 281, 381, 11, 65, "Code",ExpressionUUID->"cbf59a24-eece-4e20-a9ff-6293e5f25f2c"],
Cell[8499, 294, 600, 15, 41, "Output",ExpressionUUID->"9450140f-ba86-4150-adb6-2bb4727964a1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9148, 315, 95, 0, 54, "Subsubsection",ExpressionUUID->"e9c39986-ef05-438a-972d-797055f58a94"],
Cell[CellGroupData[{
Cell[9268, 319, 342, 9, 65, "Code",ExpressionUUID->"b26ae426-9c67-47d4-9ade-aa81276140cf"],
Cell[9613, 330, 6981, 142, 74, "Output",ExpressionUUID->"bf7fe9f4-c07b-43e1-9c71-8e4038d2eb9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16631, 477, 347, 9, 65, "Code",ExpressionUUID->"cbaf5a6d-c05d-40d4-937e-85d65e5c965f"],
Cell[16981, 488, 7022, 142, 74, "Output",ExpressionUUID->"18c6fa3e-4944-47aa-8a86-8b9ce6956c09"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24064, 637, 84, 0, 66, "Subsection",ExpressionUUID->"028eeb3b-8b08-4bf7-acf8-95d6c1414593"],
Cell[CellGroupData[{
Cell[24173, 641, 350, 9, 65, "Code",ExpressionUUID->"a4d903e8-cc67-4bcf-b763-c2477a3e89bd"],
Cell[24526, 652, 546, 16, 41, "Output",ExpressionUUID->"60b54247-0e92-4a3a-a7c9-f4bbf79bb779"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25109, 673, 411, 12, 65, "Code",ExpressionUUID->"24cecbbf-91e8-4faf-8b73-43aa3d5bd14d"],
Cell[25523, 687, 828, 25, 41, "Output",ExpressionUUID->"d478fc0c-1f09-4f46-8858-5fe91533e259"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26388, 717, 464, 13, 65, "Code",ExpressionUUID->"52ce40f3-17ab-413d-bda8-86ecc00090f9"],
Cell[26855, 732, 828, 25, 41, "Output",ExpressionUUID->"044a1e3c-da71-4d08-a658-b7969eb051ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27720, 762, 378, 10, 65, "Code",ExpressionUUID->"f028ccc4-8fd6-4fa0-8f3c-bbdb74fcb76c"],
Cell[28101, 774, 828, 25, 41, "Output",ExpressionUUID->"9c4a9380-1e6f-4a94-a01d-7e7973df667e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28966, 804, 663, 19, 65, "Code",ExpressionUUID->"02ed57f9-11f4-43d6-9d8c-e8df6c42c06c"],
Cell[29632, 825, 1968, 55, 92, "Output",ExpressionUUID->"e0a07acc-e93c-4561-800e-e222c6577547"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31637, 885, 96, 0, 54, "Subsubsection",ExpressionUUID->"c4e7b34d-b93f-4a68-a24e-3daf221827fe"],
Cell[CellGroupData[{
Cell[31758, 889, 335, 9, 65, "Code",ExpressionUUID->"f573d282-753b-4eae-acac-ce228f4ba463"],
Cell[32096, 900, 440, 13, 41, "Output",ExpressionUUID->"2e367b80-e52a-475a-b7b0-5b17f49b4db5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32573, 918, 373, 10, 65, "Code",ExpressionUUID->"9b799d2b-84d2-4465-b0ff-dc5819e06e26"],
Cell[32949, 930, 661, 20, 41, "Output",ExpressionUUID->"0c31d117-ffe9-4090-8cde-f13cc8a76bd8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33659, 956, 93, 0, 54, "Subsubsection",ExpressionUUID->"e860ef94-2eeb-4713-93a7-691bd2cf9a1d"],
Cell[CellGroupData[{
Cell[33777, 960, 438, 13, 65, "Code",ExpressionUUID->"91565f78-c1e4-4fa5-a797-dfce0d714a77"],
Cell[34218, 975, 1284, 37, 67, "Output",ExpressionUUID->"cfb86cee-aa40-43f2-900b-d192688ac8ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35539, 1017, 393, 11, 65, "Code",ExpressionUUID->"368ac821-98da-4903-9ac1-140372720c7b"],
Cell[35935, 1030, 1284, 37, 67, "Output",ExpressionUUID->"f20866ac-0b3c-4f76-8081-a0044b3fc1f5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37268, 1073, 95, 0, 54, "Subsubsection",ExpressionUUID->"9ac4795c-9635-4c2d-b84d-0887910e49ab"],
Cell[CellGroupData[{
Cell[37388, 1077, 201, 4, 65, "Code",ExpressionUUID->"3ac1387d-fe43-468e-82e6-1dce558e0579"],
Cell[37592, 1083, 7005, 141, 74, "Output",ExpressionUUID->"82861d19-292d-4292-a06e-9413f90edb9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44634, 1229, 236, 5, 65, "Code",ExpressionUUID->"5ef27613-20a7-4728-8cda-e2d3ddb37285"],
Cell[44873, 1236, 7157, 143, 74, "Output",ExpressionUUID->"8f9e6b69-c9c1-4d87-a220-1ad598f75343"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52091, 1386, 89, 0, 66, "Subsection",ExpressionUUID->"9de0ba20-012f-4a24-be34-b18b931fc5df"],
Cell[CellGroupData[{
Cell[52205, 1390, 230, 5, 65, "Code",ExpressionUUID->"1cc55161-dd94-4607-a7fe-2c0a770da0bc"],
Cell[52438, 1397, 134, 2, 41, "Output",ExpressionUUID->"8bde1255-ff4a-4aa6-8279-cf1e6c921e19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52609, 1404, 279, 7, 65, "Code",ExpressionUUID->"0ea94ef0-f603-491a-b6b1-efd658aba4f9"],
Cell[52891, 1413, 185, 4, 41, "Output",ExpressionUUID->"f588c388-6bf8-41aa-a48d-39c9ebad09af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53113, 1422, 817, 23, 160, "Code",ExpressionUUID->"32bbb5c4-a189-46b6-a183-10df64297350"],
Cell[53933, 1447, 3058, 91, 79, "Output",ExpressionUUID->"67f85448-a836-428a-87dd-5637b83e51b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57028, 1543, 541, 15, 136, "Code",ExpressionUUID->"6b947232-b785-4c12-85be-cc150d459252"],
Cell[57572, 1560, 528, 15, 41, "Output",ExpressionUUID->"6ad41780-d24c-4c05-aa1a-a9e0bebea7d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58137, 1580, 542, 15, 136, "Code",ExpressionUUID->"b92c6845-d723-4591-bc27-9a8af490902c"],
Cell[58682, 1597, 708, 21, 41, "Output",ExpressionUUID->"4e2e3d47-b744-441b-81fb-acfa85b5e756"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59427, 1623, 94, 0, 54, "Subsubsection",ExpressionUUID->"68f8edbc-8d33-4f5a-a6ea-480f520e124b"],
Cell[CellGroupData[{
Cell[59546, 1627, 309, 7, 65, "Code",ExpressionUUID->"4e302271-e6ff-4028-9784-3edbfc1b33ef"],
Cell[59858, 1636, 1025, 20, 152, "Message",ExpressionUUID->"73aab133-677a-4196-b5b6-fe3779e50293"],
Cell[60886, 1658, 108, 1, 41, "Output",ExpressionUUID->"ff7ce4ff-cbca-41d7-94c4-3783ec5ab7e1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61043, 1665, 90, 0, 54, "Subsubsection",ExpressionUUID->"c8932fc5-0188-4aa3-8766-9dff6278a2f3"],
Cell[CellGroupData[{
Cell[61158, 1669, 356, 8, 65, "Code",ExpressionUUID->"81565a34-a636-4a66-aae6-045fc23a83aa"],
Cell[61517, 1679, 182, 4, 41, "Output",ExpressionUUID->"61fc097b-1392-4a93-8c20-2b07d385c8b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61736, 1688, 335, 8, 65, "Code",ExpressionUUID->"a71d01c9-3cdf-4747-a17c-d8e282ceaf29"],
Cell[62074, 1698, 135, 2, 41, "Output",ExpressionUUID->"47c7e856-5cc0-44e0-95a5-e3fedb8cac94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62246, 1705, 257, 6, 65, "Code",ExpressionUUID->"9d0fe427-a839-47ba-a146-5010b33a6cce"],
Cell[62506, 1713, 135, 2, 41, "Output",ExpressionUUID->"e560c2fc-879e-4ca9-96c4-84813709ae74"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62690, 1721, 95, 0, 54, "Subsubsection",ExpressionUUID->"92d2a3f2-b661-4fba-a0db-d9e19a21eaeb"],
Cell[CellGroupData[{
Cell[62810, 1725, 279, 7, 65, "Code",ExpressionUUID->"baa990df-8787-4b5d-81ef-ec49ac0cae5d"],
Cell[63092, 1734, 162, 3, 41, "Output",ExpressionUUID->"8a20487b-6669-4ffb-be72-6fca1e935dc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63291, 1742, 232, 5, 65, "Code",ExpressionUUID->"c56fd884-dad4-4888-b17b-f81e5e853a07"],
Cell[63526, 1749, 146, 2, 41, "Output",ExpressionUUID->"28398937-f8ca-4fb7-a9ff-35ab1f5bbf1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63709, 1756, 222, 5, 65, "Code",ExpressionUUID->"3affcefd-55f2-41c9-bb30-11e5a6ef989c"],
Cell[63934, 1763, 218, 5, 41, "Output",ExpressionUUID->"de87153a-0dfa-4311-bf3e-100ba5b67768"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64189, 1773, 205, 4, 65, "Code",ExpressionUUID->"8b5c94ac-2630-47bb-b361-e8f48fb77874"],
Cell[64397, 1779, 173, 3, 41, "Output",ExpressionUUID->"4ed3c217-f3a5-4a7a-90e5-e68a0167de7d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64631, 1789, 84, 0, 66, "Subsection",ExpressionUUID->"a72d23ba-3074-43e4-8ff4-5681f0f2b915"],
Cell[CellGroupData[{
Cell[64740, 1793, 93, 0, 54, "Subsubsection",ExpressionUUID->"9bd34e72-643e-45ad-b8a9-f6fb752e02f2"],
Cell[CellGroupData[{
Cell[64858, 1797, 409, 11, 65, "Code",ExpressionUUID->"068ae918-9902-4bf9-8d87-f1fe62a4d3b6"],
Cell[65270, 1810, 1290, 37, 67, "Output",ExpressionUUID->"5b0c5470-1bab-4a5f-9a29-0b3e3716b2d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66597, 1852, 383, 10, 65, "Code",ExpressionUUID->"8d2eea1f-dd82-4d2d-a669-4f6df8484a6b"],
Cell[66983, 1864, 1029, 30, 67, "Output",ExpressionUUID->"05bda7d1-0151-47f6-a76b-828764050fcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68049, 1899, 382, 10, 65, "Code",ExpressionUUID->"e431a95e-dc21-4f74-a710-aa3b2e1018ea"],
Cell[68434, 1911, 1451, 43, 67, "Output",ExpressionUUID->"9b62e202-d0be-4a7c-8fb9-bb16602666e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69922, 1959, 386, 10, 65, "Code",ExpressionUUID->"8f455cc3-ef15-4283-bd0a-acfb271849f1"],
Cell[70311, 1971, 1529, 43, 67, "Output",ExpressionUUID->"e479e194-1dcf-4be7-a8b2-f330cbe3347c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71877, 2019, 386, 10, 65, "Code",ExpressionUUID->"a2d609d3-84a4-4a28-bc8e-728cbca9db16"],
Cell[72266, 2031, 1451, 43, 67, "Output",ExpressionUUID->"fbca8e39-0022-4770-a0e3-29376083af32"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73766, 2080, 94, 0, 54, "Subsubsection",ExpressionUUID->"e84dfe81-09b4-4c51-b328-279b92b70f7b"],
Cell[CellGroupData[{
Cell[73885, 2084, 228, 5, 65, "Code",ExpressionUUID->"34252dc3-e7ac-4f44-9be6-ad0210774f51"],
Cell[74116, 2091, 6895, 137, 74, "Output",ExpressionUUID->"c199f36f-2b3e-4fd8-b117-9e67edb9de8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81048, 2233, 224, 5, 65, "Code",ExpressionUUID->"2e8511d3-2509-4f86-85a3-2d7ec01ae78b"],
Cell[81275, 2240, 6864, 137, 74, "Output",ExpressionUUID->"5e4a1967-6570-4d91-adb6-47762e34900a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

