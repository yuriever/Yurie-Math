(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    105732,       2820]
NotebookOptionsPosition[     91942,       2555]
NotebookOutlinePosition[     92395,       2573]
CellTagsIndexPosition[     92352,       2570]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "Yurie`Math`"}]], "Code",
 CellLabel->"In[1]:=",ExpressionUUID->"0e356f6d-bf98-4447-9a33-73191d6da219"],

Cell[CellGroupData[{

Cell["label", "Subsection",ExpressionUUID->"32cd0893-7082-4e2c-8e01-d54bc5655161"],

Cell[CellGroupData[{

Cell["Basic", "Subsubsection",ExpressionUUID->"a25e9918-8c52-4afd-9cee-0f3921e2eaea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"label", "[", 
  RowBox[{"x", ",", "1", ",", "Symbol"}], "]"}]], "Code",
 CellLabel->
  "In[132]:=",ExpressionUUID->"4e42c48b-b7ff-4871-8896-894951ca0da3"],

Cell[BoxData["x1"], "Output",
 CellLabel->
  "Out[132]=",ExpressionUUID->"d76e7d5d-8fc5-4be2-8a0b-eaf9e7820c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Outer", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "c", ",", "\"\<c\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[133]:=",ExpressionUUID->"8b92569e-aa83-4c8d-822c-670405c10530"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc", ",", 
     RowBox[{"x", "[", "c", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "c"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc", ",", 
     RowBox[{"x", "[", "\<\"c\"\>", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "\<\"c\"\>"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->
  "Out[133]=",ExpressionUUID->"98b3cae3-6a9e-437f-bbe4-4a757dccc081"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Default", "Subsubsection",ExpressionUUID->"c3b112ea-b4db-4950-a1da-1598217a4c3e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"label", "[", 
   RowBox[{
    RowBox[{"x", "|", "y"}], ",", 
    RowBox[{"1", "|", "2"}]}], "]"}], "}"}]], "Code",
 CellLabel->
  "In[134]:=",ExpressionUUID->"ba42335b-f01b-4ef4-b307-cba29a6b1cdf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "2", "]"}]}], "}"}]], "Output",
 CellLabel->
  "Out[134]=",ExpressionUUID->"9cc2c05c-2767-4256-af18-b2987a5068c4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pattern variable", "Subsubsection",ExpressionUUID->"0d5baec8-7cab-42a6-8e3d-e75b700a60e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"label", "[", 
  RowBox[{"x_", ",", "1", ",", "Symbol"}], "]"}]], "Code",
 CellLabel->
  "In[135]:=",ExpressionUUID->"f80496c2-aa95-436f-ae61-432d81e76874"],

Cell[BoxData["x1_"], "Output",
 CellLabel->
  "Out[135]=",ExpressionUUID->"2077dd52-6e9b-4af7-967d-920c3b17ae6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Outer", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x_", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "c", ",", "\"\<c\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[136]:=",ExpressionUUID->"b467c368-ecc2-4efd-9446-fc6cc106a2ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1_", ",", 
     RowBox[{"x_", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x_", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc_", ",", 
     RowBox[{"x_", "[", "c", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x_", ",", "c"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xc_", ",", 
     RowBox[{"x_", "[", "\<\"c\"\>", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x_", ",", "\<\"c\"\>"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->
  "Out[136]=",ExpressionUUID->"c04af4a4-4041-42e6-ae26-49fd37e17527"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"label", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y__", ",", "z___", ",", "w_List", ",", 
      RowBox[{"u", ":", "pat"}]}], "}"}], ",", "1", ",", "Symbol"}], "]"}], 
  "}"}]], "Code",
 CellLabel->
  "In[137]:=",ExpressionUUID->"d23ef260-f63f-4173-96c7-f9bb71949c75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1_", ",", "y1__", ",", "z1___", ",", "w1_List", ",", 
   RowBox[{"u1", ":", "pat"}]}], "}"}]], "Output",
 CellLabel->
  "Out[137]=",ExpressionUUID->"5535673b-2ede-468c-b8a2-2d6aa9e5b674"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"label", "[", 
   RowBox[{
    RowBox[{"x_", "|", "y_"}], ",", 
    RowBox[{"Range", "[", "4", "]"}], ",", "Symbol"}], "]"}], "}"}]], "Code",
 CellLabel->
  "In[138]:=",ExpressionUUID->"92ea0e23-aa25-4e63-9e0f-272c03a5a60c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "y1_", ",", "y2_", ",", 
   "y3_", ",", "y4_"}], "}"}]], "Output",
 CellLabel->
  "Out[138]=",ExpressionUUID->"93221baf-d618-4870-965d-9dff84226206"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol with format definition", "Subsubsection",ExpressionUUID->"98bf7fef-f2ef-421a-9686-3e305100a7ab"],

Cell[BoxData[
 RowBox[{"ToExpression", "[", "\"\<Format[phat]:=OverHat[p]\>\"", 
  "]"}]], "Code",
 CellLabel->"In[3]:=",ExpressionUUID->"48d3e96f-b21d-497b-8fb2-d6805447f044"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"label", "[", 
   RowBox[{"phat", ",", "1"}], "]"}], "//", "FullForm"}]], "Code",
 CellLabel->"In[4]:=",ExpressionUUID->"12712ef7-07b7-4ca1-a834-c4fbf56ac80a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"phat", "[", "1", "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellLabel->
  "Out[4]//FullForm=",ExpressionUUID->"db72d0ac-542e-40ad-af63-99cdfe60026c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phat1", "//", 
   RowBox[{"labelSplit", "[", "phat", "]"}]}], "//", "FullForm"}]], "Code",
 CellLabel->"In[5]:=",ExpressionUUID->"edd98575-2e24-4843-9e80-496bf657ea01"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"phat", "[", "1", "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellLabel->
  "Out[5]//FullForm=",ExpressionUUID->"3c709606-5208-4a2d-bbeb-29c928ff6877"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "phat", "]"}]], "Code",
 CellLabel->"In[6]:=",ExpressionUUID->"8d4e7cee-65fe-4a6b-9a0e-1b2b222715db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["List argument", "Subsubsection",ExpressionUUID->"d438ec4f-6b36-4e53-b771-9d8c6d708e70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[85]:=",ExpressionUUID->"6ede04a8-163b-49a7-a38b-9897767a9818"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[85]=",ExpressionUUID->"e16cbd4a-558b-48f7-8461-29d5163a2180"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "1", ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[86]:=",ExpressionUUID->"c64f97c7-e33d-4464-bba3-c4e897e7bc5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[86]=",ExpressionUUID->"d5dff624-b233-48ed-8008-968e207c6478"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[87]:=",ExpressionUUID->"d7a37ba9-89bb-4cff-984f-492bd1c2246a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "2", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "2"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[87]=",ExpressionUUID->"e73a45a4-99d3-4a74-b6bb-f02b5f4ad717"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x", ",", 
      RowBox[{"1", "|", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[88]:=",ExpressionUUID->"94b21c42-62dd-468c-bc6f-96fcfaa7a537"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[88]=",ExpressionUUID->"82b81eee-02e1-495b-bed8-a43b022b98ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", "1", ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[89]:=",ExpressionUUID->"75676d24-6f87-4012-9cb8-066558dd563c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[89]=",ExpressionUUID->"660d07d4-bf95-40ca-adb4-aa663f925721"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", 
      RowBox[{"1", "|", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[90]:=",ExpressionUUID->"7f3d0036-802b-41d1-a8fc-aad0a7548f2a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2", ",", 
   RowBox[{"x", "[", "1", "]"}], ",", 
   RowBox[{"x", "[", "2", "]"}], ",", 
   RowBox[{"y", "[", "1", "]"}], ",", 
   RowBox[{"y", "[", "2", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", "2"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"y", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[90]=",ExpressionUUID->"38be1cf8-f59e-462f-b0a9-fa6a3ea8555f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Invalid pattern", "Subsubsection",ExpressionUUID->"e9c39986-ef05-438a-972d-797055f58a94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[91]:=",ExpressionUUID->"b26ae426-9c67-47d4-9ade-aa81276140cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["x", HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"-", "1"}], HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {$CellContext`x, -1}, "Var" -> $CellContext`x, 
      "Label" -> -1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"x", "[", 
    RowBox[{"-", "1"}], "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[91]=",ExpressionUUID->"760c4f71-4fd5-4517-b153-053afc5a6b84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"label", "[", 
     RowBox[{
      RowBox[{"x", "[", "]"}], ",", "1", ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[92]:=",ExpressionUUID->"cbaf5a6d-c05d-40d4-937e-85d65e5c965f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"x", "[", "]"}], HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["1", HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {
        $CellContext`x[], 1}, "Var" -> $CellContext`x[], "Label" -> 1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{
    RowBox[{"x", "[", "]"}], "[", "1", "]"}], ",", 
   RowBox[{"head", "[", 
    RowBox[{
     RowBox[{"x", "[", "]"}], ",", "1"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[92]=",ExpressionUUID->"504eba21-e0d2-4477-85fa-2afa54e6a0a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["labelAt", "Subsection",ExpressionUUID->"028eeb3b-8b08-4bf7-acf8-95d6c1414593"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"1", "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[93]:=",ExpressionUUID->"a4d903e8-cc67-4bcf-b763-c2477a3e89bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{"x1", "\[Rule]", "1"}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"head", "[", 
       RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[93]=",ExpressionUUID->"0295c6df-9182-48e5-97c4-9951b583e3e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "->", "1"}], ",", "#"}], "]"}], "&"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[94]:=",ExpressionUUID->"24cecbbf-91e8-4faf-8b73-43aa3d5bd14d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[94]=",ExpressionUUID->"3992900d-a752-408e-8aaf-c9fe13ecf869"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[95]:=",ExpressionUUID->"52ce40f3-17ab-413d-bda8-86ecc00090f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "2"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "2"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "2"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[95]=",ExpressionUUID->"aa3bbf50-2946-4efb-a866-26585345c431"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"1", "|", "2"}], "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[96]:=",ExpressionUUID->"f028ccc4-8fd6-4fa0-8f3c-bbdb74fcb76c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[96]=",ExpressionUUID->"1f5c8276-32a9-46ca-8063-7600195339a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"1", "->", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "->", "4"}], ",", 
      RowBox[{
       RowBox[{"6", "|", "7"}], "->", "5"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[97]:=",ExpressionUUID->"02ed57f9-11f4-43d6-9d8c-e8df6c42c06c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "1"}], ",", 
      RowBox[{"x2", "\[Rule]", "2"}], ",", 
      RowBox[{"x3", "\[Rule]", "3"}], ",", 
      RowBox[{"x4", "\[Rule]", "4"}], ",", 
      RowBox[{"x5", "\[Rule]", "4"}], ",", 
      RowBox[{"x6", "\[Rule]", "5"}], ",", 
      RowBox[{"x7", "\[Rule]", "5"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "3", "]"}], "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "4", "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "6", "]"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "7", "]"}], "\[Rule]", "5"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "3"}], "]"}], "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "4"}], "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "5"}], "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "6"}], "]"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "7"}], "]"}], "\[Rule]", "5"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[97]=",ExpressionUUID->"7c9898e1-9779-45bc-b551-b069ce8d21c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pattern variable", "Subsubsection",ExpressionUUID->"c4e7b34d-b93f-4a68-a24e-3daf221827fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"_", "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[98]:=",ExpressionUUID->"f573d282-753b-4eae-acac-ce228f4ba463"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "_", "]"}], "\[Rule]", "1"}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"head", "[", 
       RowBox[{"x", ",", "_"}], "]"}], "\[Rule]", "1"}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[98]=",ExpressionUUID->"db6ca3f1-2ff2-43ee-b8ed-fff4641072d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"2", "->", "2"}], ",", 
      RowBox[{"_", "->", "1"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->"In[99]:=",ExpressionUUID->"9b799d2b-84d2-4465-b0ff-dc5819e06e26"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "_", "]"}], "\[Rule]", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "2"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "_"}], "]"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[99]=",ExpressionUUID->"7461a25d-c5a4-4243-8477-65030c203bd4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["List argument", "Subsubsection",ExpressionUUID->"e860ef94-2eeb-4713-93a7-691bd2cf9a1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{
      RowBox[{"x", "|", "y"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "->", "a"}], ",", "#"}], "]"}], "&"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[100]:=",ExpressionUUID->"91565f78-c1e4-4fa5-a797-dfce0d714a77"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "a"}], ",", 
      RowBox[{"x2", "\[Rule]", "a"}], ",", 
      RowBox[{"y1", "\[Rule]", "a"}], ",", 
      RowBox[{"y2", "\[Rule]", "a"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "2", "]"}], "\[Rule]", "a"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "2"}], "]"}], "\[Rule]", "a"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[100]=",ExpressionUUID->"e17aa76c-ff9a-4e06-8fee-54dd89eb15cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelAt", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"1", "->", "a"}], ",", 
      RowBox[{"2", "->", "b"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[101]:=",ExpressionUUID->"368ac821-98da-4903-9ac1-140372720c7b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", "a"}], ",", 
      RowBox[{"x2", "\[Rule]", "b"}], ",", 
      RowBox[{"y1", "\[Rule]", "a"}], ",", 
      RowBox[{"y2", "\[Rule]", "b"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "\[Rule]", "b"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "1", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "2", "]"}], "\[Rule]", "b"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "2"}], "]"}], "\[Rule]", "b"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "1"}], "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"y", ",", "2"}], "]"}], "\[Rule]", "b"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[101]=",ExpressionUUID->"d3b03a25-ade1-4be6-807b-a2a2b7183d09"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Invalid pattern", "Subsubsection",ExpressionUUID->"9ac4795c-9635-4c2d-b84d-0887910e49ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelAt", "[", 
  RowBox[{"x", ",", 
   RowBox[{"_", "->", "1"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->
  "In[102]:=",ExpressionUUID->"3ac1387d-fe43-468e-82e6-1dce558e0579"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      TagBox["Failure",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               FrameBox[
                StyleBox["\"\[WarningSign]\"", 
                 Directive["Message", 35], StripOnInput -> False], 
                ContentPadding -> False, FrameStyle -> None, 
                FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}, {
                  TagBox[
                   GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               FrameBox[
                StyleBox["\"\[WarningSign]\"", 
                 Directive["Message", 35], StripOnInput -> False], 
                ContentPadding -> False, FrameStyle -> None, 
                FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}, {
                  TagBox[
                   GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                   "SummaryItem"]}, {
                  RowBox[{
                    TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["x", HoldForm], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["_", HoldForm], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     Failure[
     "InvalidSymbol", <|
      "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
       "MessageParameters" -> {$CellContext`x, 
         Blank[]}, "Var" -> $CellContext`x, "Label" -> Blank[]|>],
     Editable->False,
     SelectWithContents->True,
     Selectable->False], "\[Rule]", "1"}], "}"}], "]"}]], "Output",
 CellLabel->
  "Out[102]=",ExpressionUUID->"4b4a35e8-da45-468e-b43c-032b1279a599"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelAt", "[", 
  RowBox[{"x", ",", 
   RowBox[{"2", "->", "2"}], ",", 
   RowBox[{"_", "->", "1"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->
  "In[103]:=",ExpressionUUID->"5ef27613-20a7-4728-8cda-e2d3ddb37285"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x2", "\[Rule]", "2"}], ",", 
    RowBox[{
     InterpretationBox[
      RowBox[{
       TagBox["Failure",
        "SummaryHead"], "[", 
       DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
        "Ready"}, 
        TemplateBox[{
          PaneSelectorBox[{False -> GridBox[{{
                PaneBox[
                 ButtonBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "FEBitmaps", "SummaryBoxOpener"]], 
                  ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                  None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                  "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                 Dynamic[{
                   Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                FrameBox[
                 StyleBox["\"\[WarningSign]\"", 
                  Directive["Message", 35], StripOnInput -> False], 
                 ContentPadding -> False, FrameStyle -> None, 
                 FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
                GridBox[{{
                   TagBox[
                    GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}, {
                   TagBox[
                    GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                 False, GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                 BaseStyle -> {
                  ShowStringCharacters -> False, NumberMarks -> False, 
                   PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
              GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
              AutoDelete -> False, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              BaselinePosition -> {1, 1}], True -> GridBox[{{
                PaneBox[
                 ButtonBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "FEBitmaps", "SummaryBoxCloser"]], 
                  ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                  None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                  "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                 Dynamic[{
                   Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                FrameBox[
                 StyleBox["\"\[WarningSign]\"", 
                  Directive["Message", 35], StripOnInput -> False], 
                 ContentPadding -> False, FrameStyle -> None, 
                 FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
                GridBox[{{
                   TagBox[
                    GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"x\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[\\\"_\\\", Function[Short[Slot[1], 5]]]\\) is not a \
valid labeled symbol.\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}, {
                   TagBox[
                    GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                    GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridBoxSpacings -> {"Columns" -> {{0}}}], 
                    "SummaryItem"]}, {
                   RowBox[{
                    TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["x", HoldForm], "SummaryItem"]}]}, {
                   RowBox[{
                    TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox[
                    TagBox["_", HoldForm], "SummaryItem"]}]}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                 False, GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                 BaseStyle -> {
                  ShowStringCharacters -> False, NumberMarks -> False, 
                   PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
              GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
              AutoDelete -> False, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              BaselinePosition -> {1, 1}]}, 
           Dynamic[Typeset`open$$], ImageSize -> Automatic]},
         "SummaryPanel"],
        DynamicModuleValues:>{}], "]"}],
      Failure[
      "InvalidSymbol", <|
       "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
        "MessageParameters" -> {$CellContext`x, 
          Blank[]}, "Var" -> $CellContext`x, "Label" -> Blank[]|>],
      Editable->False,
      SelectWithContents->True,
      Selectable->False], "\[Rule]", "1"}]}], "}"}], "]"}]], "Output",
 CellLabel->
  "Out[103]=",ExpressionUUID->"cfd0a9d8-d40b-4c74-a59c-5d1409833a33"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["labelConvert", "Subsection",ExpressionUUID->"9de0ba20-012f-4a24-be34-b18b931fc5df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x1", "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Symbol", "->", "Function"}]}], "]"}]}]], "Code",
 CellLabel->
  "In[199]:=",ExpressionUUID->"1cc55161-dd94-4607-a7fe-2c0a770da0bc"],

Cell[BoxData[
 RowBox[{"x", "[", "1", "]"}]], "Output",
 CellLabel->
  "Out[199]=",ExpressionUUID->"358d781c-ec10-49c7-9488-18ee1f2e1edd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x1", "+", "y2"}], "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{
    RowBox[{"x", "|", "y"}], ",", 
    RowBox[{"Symbol", "->", "Function"}]}], "]"}]}]], "Code",
 CellLabel->
  "In[200]:=",ExpressionUUID->"0ea94ef0-f603-491a-b6b1-efd658aba4f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "1", "]"}], "+", 
  RowBox[{"y", "[", "2", "]"}]}]], "Output",
 CellLabel->
  "Out[200]=",ExpressionUUID->"56b0cbb7-2161-4b40-9834-0d3641938378"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Outer", "[", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "->", 
      RowBox[{
       RowBox[{"labelConvert", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"#1", "->", "#2"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]}], "&"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "\n", "]"}], "//",
   "MatrixForm"}]], "Code",
 CellLabel->
  "In[201]:=",ExpressionUUID->"32bbb5c4-a189-46b6-a183-10df64297350"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Symbol", ",", "Symbol"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Symbol", ",", "Function"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Symbol", ",", "head"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Function", ",", "Symbol"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x1", ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Function", ",", "Function"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Function", ",", "head"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "Symbol"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", "x1"}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "Function"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}]}], "}"}]}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "head"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"head", "[", 
          RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[201]//MatrixForm=",ExpressionUUID->"76b61be6-4d4e-432c-9d47-\
1a6ce8980b66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"labelJoin", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "#1"}], "]"}], "@", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], "&"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "\n", 
  "]"}]], "Code",
 CellLabel->
  "In[202]:=",ExpressionUUID->"6b947232-b785-4c12-85be-cc150d459252"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x1", ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", "x1"}], "}"}]}], "}"}]], "Output",
 CellLabel->
  "Out[202]=",ExpressionUUID->"4d0faaa5-c363-48e0-8f92-ade61992db17"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"labelSplit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "#1"}], "]"}], "@", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"head", "[", 
        RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], "&"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "\n", 
  "]"}]], "Code",
 CellLabel->
  "In[203]:=",ExpressionUUID->"b92c6845-d723-4591-bc27-9a8af490902c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}], ",", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"head", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->
  "Out[203]=",ExpressionUUID->"6b119f6d-836c-4ad4-9d2b-4e16df0f2720"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error handling", "Subsubsection",ExpressionUUID->"68f8edbc-8d33-4f5a-a6ea-480f520e124b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"labelConvert", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Symbol", "->", "Function"}], ",", 
    RowBox[{"\"\<LabelType\>\"", "->", "\"\<UndefinedType\>\""}]}], "]"}], "[",
   "x1", "]"}]], "Code",
 CellLabel->
  "In[104]:=",ExpressionUUID->"4e302271-e6ff-4028-9784-3edbfc1b33ef"],

Cell[BoxData[
 TemplateBox[{
  "label", "UndefinedType", 
   "\"the label type \\!\\(\\*RowBox[{\\\"\\\\\\\"UndefinedType\\\\\\\"\\\"}]\
\\) is undefined, and should be one of the \
followings:\\n\\!\\(\\*TagBox[GridBox[{{\\\"\\\\\\\"PositiveInteger\\\\\\\"\\\
\"}, {\\\"\\\\\\\"PositiveIntegerOrSingleLetter\\\\\\\"\\\"}, \
{\\\"\\\\\\\"PositiveIntegerOrGreekLetter\\\\\\\"\\\"}, \
{\\\"\\\\\\\"NaturalNumber\\\\\\\"\\\"}, \
{\\\"\\\\\\\"NaturalNumberOrSingleLetter\\\\\\\"\\\"}, \
{\\\"\\\\\\\"NaturalNumberOrGreekLetter\\\\\\\"\\\"}}, Rule[GridBoxAlignment, \
List[Rule[\\\"Columns\\\", List[List[Left]]]]], Rule[DefaultBaseStyle, \
\\\"Column\\\"], Rule[GridBoxItemSize, List[Rule[\\\"Columns\\\", \
List[List[Automatic]]], Rule[\\\"Rows\\\", List[List[Automatic]]]]]], \
\\\"Column\\\"]\\).\"", 2, 104, 1, 24655489507347738043, "Local", 
   "Yurie`Math`label"},
  "MessageTemplate2",
  BaseStyle->"MSG"]], "Message",
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"bb7e9ce2-f966-4563-85a9-0b2ae6611e9d"],

Cell[BoxData["x1"], "Output",
 CellLabel->
  "Out[104]=",ExpressionUUID->"abbe221c-0e76-48d9-8d6c-588c2831fbdd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Label type", "Subsubsection",ExpressionUUID->"c8932fc5-0188-4aa3-8766-9dff6278a2f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"labelConvert", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Symbol", "->", "Function"}], ",", 
    RowBox[{"\"\<LabelType\>\"", "->", "\"\<PositiveInteger\>\""}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x0"}], "}"}], "]"}]], "Code",
 CellLabel->
  "In[106]:=",ExpressionUUID->"81565a34-a636-4a66-aae6-045fc23a83aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], ",", "x0"}], "}"}]], "Output",
 CellLabel->
  "Out[106]=",ExpressionUUID->"7fc9e7d0-d04e-446b-bff4-08b8d01d70d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zb1", "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{
    RowBox[{"z", "|", "zb"}], ",", 
    RowBox[{"Symbol", "->", "Function"}], ",", 
    RowBox[{"\"\<LabelType\>\"", "->", "\"\<PositiveInteger\>\""}]}], 
   "]"}]}]], "Code",
 CellLabel->
  "In[107]:=",ExpressionUUID->"a71d01c9-3cdf-4747-a17c-d8e282ceaf29"],

Cell[BoxData[
 RowBox[{"zb", "[", "1", "]"}]], "Output",
 CellLabel->
  "Out[107]=",ExpressionUUID->"683c2e72-c0b0-4a39-8296-e1fe1bf6512b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zb1", "//", 
  RowBox[{"labelConvert", "[", 
   RowBox[{
    RowBox[{"z", "|", "zb"}], ",", 
    RowBox[{"Symbol", "->", "Function"}]}], "]"}]}]], "Code",
 CellLabel->
  "In[108]:=",ExpressionUUID->"9d0fe427-a839-47ba-a146-5010b33a6cce"],

Cell[BoxData[
 RowBox[{"z", "[", "b1", "]"}]], "Output",
 CellLabel->
  "Out[108]=",ExpressionUUID->"77966241-b2b2-4a4f-bbb7-2a5984818d1f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Held expression", "Subsubsection",ExpressionUUID->"92d2a3f2-b661-4fba-a0db-d9e19a21eaeb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hold", "[", 
   RowBox[{
    RowBox[{"x", "[", "1", "]"}], "+", 
    RowBox[{"x", "[", "2", "]"}]}], "]"}], "//", 
  RowBox[{"labelJoin", "[", "x", "]"}]}]], "Code",
 CellLabel->
  "In[109]:=",ExpressionUUID->"baa990df-8787-4b5d-81ef-ec49ac0cae5d"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"x1", "+", "x2"}], "]"}]], "Output",
 CellLabel->
  "Out[109]=",ExpressionUUID->"6df1777a-ab18-4e5d-b47a-883947164cc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldComplete", "[", 
   RowBox[{"x", "[", "1", "]"}], "]"}], "//", 
  RowBox[{"labelJoin", "[", "x", "]"}]}]], "Code",
 CellLabel->
  "In[110]:=",ExpressionUUID->"c56fd884-dad4-4888-b17b-f81e5e853a07"],

Cell[BoxData[
 RowBox[{"HoldComplete", "[", "x1", "]"}]], "Output",
 CellLabel->
  "Out[110]=",ExpressionUUID->"d4b8e1e9-6881-4e54-bc86-64bd701f4e2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hold", "[", 
   RowBox[{"x1", "+", "x2"}], "]"}], "//", 
  RowBox[{"labelSplit", "[", "x", "]"}]}]], "Code",
 CellLabel->
  "In[112]:=",ExpressionUUID->"3affcefd-55f2-41c9-bb30-11e5a6ef989c"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], "+", 
   RowBox[{"x", "[", "2", "]"}]}], "]"}]], "Output",
 CellLabel->
  "Out[112]=",ExpressionUUID->"6d954bb9-e27c-48cd-9a1a-4ffbed1b91a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldComplete", "[", "x1", "]"}], "//", 
  RowBox[{"labelSplit", "[", "x", "]"}]}]], "Code",
 CellLabel->
  "In[113]:=",ExpressionUUID->"8b5c94ac-2630-47bb-b361-e8f48fb77874"],

Cell[BoxData[
 RowBox[{"HoldComplete", "[", 
  RowBox[{"x", "[", "1", "]"}], "]"}]], "Output",
 CellLabel->
  "Out[113]=",ExpressionUUID->"bf05b200-c877-4351-8cd9-580af1ee53e4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["labelTo", "Subsection",ExpressionUUID->"a72d23ba-3074-43e4-8ff4-5681f0f2b915"],

Cell[CellGroupData[{

Cell["List argument", "Subsubsection",ExpressionUUID->"9bd34e72-643e-45ad-b8a9-f6fb752e02f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToZero", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[124]:=",ExpressionUUID->"068ae918-9902-4bf9-8d87-f1fe62a4d3b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", "0"}], ",", 
      RowBox[{"z2", "\[Rule]", "0"}], ",", 
      RowBox[{"zb1", "\[Rule]", "0"}], ",", 
      RowBox[{"zb2", "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[124]=",ExpressionUUID->"f671b0d2-3b53-4274-83ce-8eb882617b0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToEqual", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[125]:=",ExpressionUUID->"8d2eea1f-dd82-4d2d-a669-4f6df8484a6b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", "z2"}], ",", 
      RowBox[{"zb1", "\[Rule]", "zb2"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"z", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"zb", "[", "2", "]"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "2"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "2"}], "]"}]}]}], "}"}], "]"}]}], "}"}]], "Output",
 CellLabel->
  "Out[125]=",ExpressionUUID->"bb9ab83d-26f7-483e-8d91-c4947625e140"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToDiff", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[126]:=",ExpressionUUID->"e431a95e-dc21-4f74-a710-aa3b2e1018ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", 
       RowBox[{"z12", "+", "z2"}]}], ",", 
      RowBox[{"zb1", "\[Rule]", 
       RowBox[{"zb12", "+", "zb2"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], "+", 
        RowBox[{"z", "[", "\<\"12\"\>", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"zb", "[", "2", "]"}], "+", 
        RowBox[{"zb", "[", "\<\"12\"\>", "]"}]}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "2"}], "]"}], "+", 
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "\<\"12\"\>"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "2"}], "]"}], "+", 
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "\<\"12\"\>"}], "]"}]}]}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[126]=",ExpressionUUID->"f97899d6-a04a-4215-9806-0e7de8ac07d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToDiffZero", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[127]:=",ExpressionUUID->"8f455cc3-ef15-4283-bd0a-acfb271849f1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "\[Rule]", "z12"}], ",", 
      RowBox[{"z2", "\[Rule]", "0"}], ",", 
      RowBox[{"zb1", "\[Rule]", "zb12"}], ",", 
      RowBox[{"zb2", "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"z", "[", "\<\"12\"\>", "]"}]}], ",", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"zb", "[", "\<\"12\"\>", "]"}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "\<\"12\"\>"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "1"}], "]"}], "\[Rule]", 
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "\<\"12\"\>"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[127]=",ExpressionUUID->"b0cd9eea-cd8e-4c62-92bd-a174a0e1762d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"labelToDiffBack", "[", 
     RowBox[{
      RowBox[{"z", "|", "zb"}], ",", 
      RowBox[{"1", "->", "2"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"Symbol", ",", "Function", ",", "head"}], "}"}]}], "]"}]], "Code",
 CellLabel->
  "In[128]:=",ExpressionUUID->"a2d609d3-84a4-4a28-bc8e-728cbca9db16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z12", "\[Rule]", 
       RowBox[{"z1", "-", "z2"}]}], ",", 
      RowBox[{"zb12", "\[Rule]", 
       RowBox[{"zb1", "-", "zb2"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "\<\"12\"\>", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], "-", 
        RowBox[{"z", "[", "2", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"zb", "[", "\<\"12\"\>", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"zb", "[", "1", "]"}], "-", 
        RowBox[{"zb", "[", "2", "]"}]}]}]}], "}"}], "]"}], ",", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"z", ",", "\<\"12\"\>"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "1"}], "]"}], "-", 
        RowBox[{"head", "[", 
         RowBox[{"z", ",", "2"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"head", "[", 
        RowBox[{"zb", ",", "\<\"12\"\>"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "1"}], "]"}], "-", 
        RowBox[{"head", "[", 
         RowBox[{"zb", ",", "2"}], "]"}]}]}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[128]=",ExpressionUUID->"863c2efe-9b11-47d9-94c2-9484f7561d5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error handling", "Subsubsection",ExpressionUUID->"e84dfe81-09b4-4c51-b328-279b92b70f7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelToZero", "[", 
  RowBox[{
   RowBox[{"z", "[", "]"}], ",", 
   RowBox[{"{", "1", "}"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->
  "In[129]:=",ExpressionUUID->"34252dc3-e7ac-4f44-9be6-ad0210774f51"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"z\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[RowBox[{\\\"z\\\", \\\"[\\\", \
\\\"]\\\"}], Function[Short[Slot[1], 5]]]\\)\\!\\(\\*TagBox[\\\"1\\\", \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"z", "[", "]"}], HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["1", HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {
        $CellContext`z[], 1}, "Var" -> $CellContext`z[], "Label" -> 1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], "\[Rule]", "0"}], "]"}]], "Output",
 CellLabel->
  "Out[129]=",ExpressionUUID->"616fe989-d148-41c2-b27a-045cda25582b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"labelToZero", "[", 
  RowBox[{"z", ",", 
   RowBox[{"{", 
    RowBox[{"-", "1"}], "}"}], ",", "Symbol"}], "]"}]], "Code",
 CellLabel->
  "In[130]:=",ExpressionUUID->"2e8511d3-2509-4f86-85a3-2d7ec01ae78b"],

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["Failure",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"z\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              FrameBox[
               StyleBox["\"\[WarningSign]\"", 
                Directive["Message", 35], StripOnInput -> False], 
               ContentPadding -> False, FrameStyle -> None, 
               FrameMargins -> {{0, 0}, {0, 0}}, StripOnInput -> False], 
              GridBox[{{
                 TagBox[
                  GridBox[{{
                    TagBox["\"Message: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    "\"\\!\\(\\*TagBox[\\\"z\\\", Function[Short[Slot[1], \
5]]]\\)\\!\\(\\*TagBox[RowBox[{\\\"-\\\", \\\"1\\\"}], \
Function[Short[Slot[1], 5]]]\\) is not a valid labeled symbol.\"", 
                    "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 TagBox[
                  GridBox[{{
                    TagBox["\"Tag: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"InvalidSymbol\"", "SummaryItem"]}}, 
                   GridBoxItemSize -> {"Columns" -> {6.5, All, Automatic}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   GridBoxSpacings -> {"Columns" -> {{0}}}], "SummaryItem"]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Var\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox["z", HoldForm], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                    TemplateBox[{"\"Label\"", "\": \""}, "RowDefault"], 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    TagBox[
                    RowBox[{"-", "1"}], HoldForm], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Failure[
    "InvalidSymbol", <|
     "MessageTemplate" :> MessageName[Yurie`Math`label, "InvalidSymbol"], 
      "MessageParameters" -> {$CellContext`z, -1}, "Var" -> $CellContext`z, 
      "Label" -> -1|>],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], "\[Rule]", "0"}], "]"}]], "Output",
 CellLabel->
  "Out[130]=",ExpressionUUID->"9a16f0b9-e1da-4c2e-a010-6161acfac4c0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Editable->True,
WindowSize->{1280, 1387},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Yurie.nb",
ExpressionUUID->"308c67c5-16d8-4b33-bbfe-12a01797f898"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 132, 2, 65, "Code",ExpressionUUID->"0e356f6d-bf98-4447-9a33-73191d6da219"],
Cell[CellGroupData[{
Cell[711, 26, 82, 0, 66, "Subsection",ExpressionUUID->"32cd0893-7082-4e2c-8e01-d54bc5655161"],
Cell[CellGroupData[{
Cell[818, 30, 85, 0, 54, "Subsubsection",ExpressionUUID->"a25e9918-8c52-4afd-9cee-0f3921e2eaea"],
Cell[CellGroupData[{
Cell[928, 34, 178, 4, 65, "Code",ExpressionUUID->"4e42c48b-b7ff-4871-8896-894951ca0da3"],
Cell[1109, 40, 112, 2, 41, "Output",ExpressionUUID->"d76e7d5d-8fc5-4be2-8a0b-eaf9e7820c2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1258, 47, 405, 11, 65, "Code",ExpressionUUID->"8b92569e-aa83-4c8d-822c-670405c10530"],
Cell[1666, 60, 638, 19, 41, "Output",ExpressionUUID->"98b3cae3-6a9e-437f-bbe4-4a757dccc081"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2353, 85, 87, 0, 54, "Subsubsection",ExpressionUUID->"c3b112ea-b4db-4950-a1da-1598217a4c3e"],
Cell[CellGroupData[{
Cell[2465, 89, 237, 7, 65, "Code",ExpressionUUID->"ba42335b-f01b-4ef4-b307-cba29a6b1cdf"],
Cell[2705, 98, 292, 8, 41, "Output",ExpressionUUID->"9cc2c05c-2767-4256-af18-b2987a5068c4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3046, 112, 96, 0, 54, "Subsubsection",ExpressionUUID->"0d5baec8-7cab-42a6-8e3d-e75b700a60e8"],
Cell[CellGroupData[{
Cell[3167, 116, 179, 4, 65, "Code",ExpressionUUID->"f80496c2-aa95-436f-ae61-432d81e76874"],
Cell[3349, 122, 113, 2, 41, "Output",ExpressionUUID->"2077dd52-6e9b-4af7-967d-920c3b17ae6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3499, 129, 406, 11, 65, "Code",ExpressionUUID->"b467c368-ecc2-4efd-9446-fc6cc106a2ae"],
Cell[3908, 142, 647, 19, 41, "Output",ExpressionUUID->"c04af4a4-4041-42e6-ae26-49fd37e17527"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4592, 166, 326, 9, 65, "Code",ExpressionUUID->"d23ef260-f63f-4173-96c7-f9bb71949c75"],
Cell[4921, 177, 228, 5, 41, "Output",ExpressionUUID->"5535673b-2ede-468c-b8a2-2d6aa9e5b674"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5186, 187, 263, 7, 65, "Code",ExpressionUUID->"92ea0e23-aa25-4e63-9e0f-272c03a5a60c"],
Cell[5452, 196, 239, 6, 41, "Output",ExpressionUUID->"93221baf-d618-4870-965d-9dff84226206"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5740, 208, 109, 0, 54, "Subsubsection",ExpressionUUID->"98bf7fef-f2ef-421a-9686-3e305100a7ab"],
Cell[5852, 210, 176, 3, 65, "Code",ExpressionUUID->"48d3e96f-b21d-497b-8fb2-d6805447f044"],
Cell[CellGroupData[{
Cell[6053, 217, 193, 4, 65, "Code",ExpressionUUID->"12712ef7-07b7-4ca1-a834-c4fbf56ac80a"],
Cell[6249, 223, 272, 9, 58, "Output",ExpressionUUID->"db72d0ac-542e-40ad-af63-99cdfe60026c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6558, 237, 203, 4, 65, "Code",ExpressionUUID->"edd98575-2e24-4843-9e80-496bf657ea01"],
Cell[6764, 243, 272, 9, 58, "Output",ExpressionUUID->"3c709606-5208-4a2d-bbeb-29c928ff6877"]
}, Open  ]],
Cell[7051, 255, 141, 2, 65, "Code",ExpressionUUID->"8d4e7cee-65fe-4a6b-9a0e-1b2b222715db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7229, 262, 93, 0, 54, "Subsubsection",ExpressionUUID->"d438ec4f-6b36-4e53-b771-9d8c6d708e70"],
Cell[CellGroupData[{
Cell[7347, 266, 375, 10, 65, "Code",ExpressionUUID->"6ede04a8-163b-49a7-a38b-9897767a9818"],
Cell[7725, 278, 366, 9, 41, "Output",ExpressionUUID->"e16cbd4a-558b-48f7-8461-29d5163a2180"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8128, 292, 375, 10, 65, "Code",ExpressionUUID->"c64f97c7-e33d-4464-bba3-c4e897e7bc5b"],
Cell[8506, 304, 366, 9, 41, "Output",ExpressionUUID->"d5dff624-b233-48ed-8008-968e207c6478"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8909, 318, 430, 12, 65, "Code",ExpressionUUID->"d7a37ba9-89bb-4cff-984f-492bd1c2246a"],
Cell[9342, 332, 600, 15, 41, "Output",ExpressionUUID->"e73a45a4-99d3-4a74-b6bb-f02b5f4ad717"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9979, 352, 347, 9, 65, "Code",ExpressionUUID->"94b21c42-62dd-468c-bc6f-96fcfaa7a537"],
Cell[10329, 363, 366, 9, 41, "Output",ExpressionUUID->"82b81eee-02e1-495b-bed8-a43b022b98ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10732, 377, 347, 9, 65, "Code",ExpressionUUID->"75676d24-6f87-4012-9cb8-066558dd563c"],
Cell[11082, 388, 366, 9, 41, "Output",ExpressionUUID->"660d07d4-bf95-40ca-adb4-aa663f925721"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11485, 402, 374, 10, 65, "Code",ExpressionUUID->"7f3d0036-802b-41d1-a8fc-aad0a7548f2a"],
Cell[11862, 414, 600, 15, 41, "Output",ExpressionUUID->"38be1cf8-f59e-462f-b0a9-fa6a3ea8555f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12511, 435, 95, 0, 54, "Subsubsection",ExpressionUUID->"e9c39986-ef05-438a-972d-797055f58a94"],
Cell[CellGroupData[{
Cell[12631, 439, 342, 9, 65, "Code",ExpressionUUID->"b26ae426-9c67-47d4-9ade-aa81276140cf"],
Cell[12976, 450, 6981, 142, 74, "Output",ExpressionUUID->"760c4f71-4fd5-4517-b153-053afc5a6b84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19994, 597, 347, 9, 65, "Code",ExpressionUUID->"cbaf5a6d-c05d-40d4-937e-85d65e5c965f"],
Cell[20344, 608, 7022, 142, 74, "Output",ExpressionUUID->"504eba21-e0d2-4477-85fa-2afa54e6a0a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27427, 757, 84, 0, 66, "Subsection",ExpressionUUID->"028eeb3b-8b08-4bf7-acf8-95d6c1414593"],
Cell[CellGroupData[{
Cell[27536, 761, 350, 9, 65, "Code",ExpressionUUID->"a4d903e8-cc67-4bcf-b763-c2477a3e89bd"],
Cell[27889, 772, 546, 16, 41, "Output",ExpressionUUID->"0295c6df-9182-48e5-97c4-9951b583e3e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28472, 793, 411, 12, 65, "Code",ExpressionUUID->"24cecbbf-91e8-4faf-8b73-43aa3d5bd14d"],
Cell[28886, 807, 828, 25, 41, "Output",ExpressionUUID->"3992900d-a752-408e-8aaf-c9fe13ecf869"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29751, 837, 464, 13, 65, "Code",ExpressionUUID->"52ce40f3-17ab-413d-bda8-86ecc00090f9"],
Cell[30218, 852, 828, 25, 41, "Output",ExpressionUUID->"aa3bbf50-2946-4efb-a866-26585345c431"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31083, 882, 378, 10, 65, "Code",ExpressionUUID->"f028ccc4-8fd6-4fa0-8f3c-bbdb74fcb76c"],
Cell[31464, 894, 828, 25, 41, "Output",ExpressionUUID->"1f5c8276-32a9-46ca-8063-7600195339a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32329, 924, 663, 19, 65, "Code",ExpressionUUID->"02ed57f9-11f4-43d6-9d8c-e8df6c42c06c"],
Cell[32995, 945, 1968, 55, 92, "Output",ExpressionUUID->"7c9898e1-9779-45bc-b551-b069ce8d21c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35000, 1005, 96, 0, 54, "Subsubsection",ExpressionUUID->"c4e7b34d-b93f-4a68-a24e-3daf221827fe"],
Cell[CellGroupData[{
Cell[35121, 1009, 335, 9, 65, "Code",ExpressionUUID->"f573d282-753b-4eae-acac-ce228f4ba463"],
Cell[35459, 1020, 440, 13, 41, "Output",ExpressionUUID->"db6ca3f1-2ff2-43ee-b8ed-fff4641072d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35936, 1038, 373, 10, 65, "Code",ExpressionUUID->"9b799d2b-84d2-4465-b0ff-dc5819e06e26"],
Cell[36312, 1050, 661, 20, 41, "Output",ExpressionUUID->"7461a25d-c5a4-4243-8477-65030c203bd4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37022, 1076, 93, 0, 54, "Subsubsection",ExpressionUUID->"e860ef94-2eeb-4713-93a7-691bd2cf9a1d"],
Cell[CellGroupData[{
Cell[37140, 1080, 442, 14, 65, "Code",ExpressionUUID->"91565f78-c1e4-4fa5-a797-dfce0d714a77"],
Cell[37585, 1096, 1288, 38, 67, "Output",ExpressionUUID->"e17aa76c-ff9a-4e06-8fee-54dd89eb15cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38910, 1139, 447, 13, 65, "Code",ExpressionUUID->"368ac821-98da-4903-9ac1-140372720c7b"],
Cell[39360, 1154, 1288, 38, 67, "Output",ExpressionUUID->"d3b03a25-ade1-4be6-807b-a2a2b7183d09"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40697, 1198, 95, 0, 54, "Subsubsection",ExpressionUUID->"9ac4795c-9635-4c2d-b84d-0887910e49ab"],
Cell[CellGroupData[{
Cell[40817, 1202, 205, 5, 65, "Code",ExpressionUUID->"3ac1387d-fe43-468e-82e6-1dce558e0579"],
Cell[41025, 1209, 7009, 142, 74, "Output",ExpressionUUID->"4b4a35e8-da45-468e-b43c-032b1279a599"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48071, 1356, 240, 6, 65, "Code",ExpressionUUID->"5ef27613-20a7-4728-8cda-e2d3ddb37285"],
Cell[48314, 1364, 7161, 144, 74, "Output",ExpressionUUID->"cfd0a9d8-d40b-4c74-a59c-5d1409833a33"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55536, 1515, 89, 0, 66, "Subsection",ExpressionUUID->"9de0ba20-012f-4a24-be34-b18b931fc5df"],
Cell[CellGroupData[{
Cell[55650, 1519, 234, 6, 65, "Code",ExpressionUUID->"1cc55161-dd94-4607-a7fe-2c0a770da0bc"],
Cell[55887, 1527, 138, 3, 41, "Output",ExpressionUUID->"358d781c-ec10-49c7-9488-18ee1f2e1edd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56062, 1535, 283, 8, 65, "Code",ExpressionUUID->"0ea94ef0-f603-491a-b6b1-efd658aba4f9"],
Cell[56348, 1545, 189, 5, 41, "Output",ExpressionUUID->"56b0cbb7-2161-4b40-9834-0d3641938378"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56574, 1555, 874, 25, 160, "Code",ExpressionUUID->"32bbb5c4-a189-46b6-a183-10df64297350"],
Cell[57451, 1582, 3059, 91, 96, "Output",ExpressionUUID->"76b61be6-4d4e-432c-9d47-1a6ce8980b66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60547, 1678, 598, 18, 136, "Code",ExpressionUUID->"6b947232-b785-4c12-85be-cc150d459252"],
Cell[61148, 1698, 532, 16, 41, "Output",ExpressionUUID->"4d0faaa5-c363-48e0-8f92-ade61992db17"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61717, 1719, 599, 18, 136, "Code",ExpressionUUID->"b92c6845-d723-4591-bc27-9a8af490902c"],
Cell[62319, 1739, 712, 22, 41, "Output",ExpressionUUID->"6b119f6d-836c-4ad4-9d2b-4e16df0f2720"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63068, 1766, 94, 0, 54, "Subsubsection",ExpressionUUID->"68f8edbc-8d33-4f5a-a6ea-480f520e124b"],
Cell[CellGroupData[{
Cell[63187, 1770, 313, 8, 65, "Code",ExpressionUUID->"4e302271-e6ff-4028-9784-3edbfc1b33ef"],
Cell[63503, 1780, 1027, 20, 152, "Message",ExpressionUUID->"bb7e9ce2-f966-4563-85a9-0b2ae6611e9d"],
Cell[64533, 1802, 112, 2, 41, "Output",ExpressionUUID->"abbe221c-0e76-48d9-8d6c-588c2831fbdd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64694, 1810, 90, 0, 54, "Subsubsection",ExpressionUUID->"c8932fc5-0188-4aa3-8766-9dff6278a2f3"],
Cell[CellGroupData[{
Cell[64809, 1814, 360, 9, 65, "Code",ExpressionUUID->"81565a34-a636-4a66-aae6-045fc23a83aa"],
Cell[65172, 1825, 186, 5, 41, "Output",ExpressionUUID->"7fc9e7d0-d04e-446b-bff4-08b8d01d70d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65395, 1835, 339, 9, 65, "Code",ExpressionUUID->"a71d01c9-3cdf-4747-a17c-d8e282ceaf29"],
Cell[65737, 1846, 139, 3, 41, "Output",ExpressionUUID->"683c2e72-c0b0-4a39-8296-e1fe1bf6512b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65913, 1854, 261, 7, 65, "Code",ExpressionUUID->"9d0fe427-a839-47ba-a146-5010b33a6cce"],
Cell[66177, 1863, 139, 3, 41, "Output",ExpressionUUID->"77966241-b2b2-4a4f-bbb7-2a5984818d1f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66365, 1872, 95, 0, 54, "Subsubsection",ExpressionUUID->"92d2a3f2-b661-4fba-a0db-d9e19a21eaeb"],
Cell[CellGroupData[{
Cell[66485, 1876, 283, 8, 65, "Code",ExpressionUUID->"baa990df-8787-4b5d-81ef-ec49ac0cae5d"],
Cell[66771, 1886, 166, 4, 41, "Output",ExpressionUUID->"6df1777a-ab18-4e5d-b47a-883947164cc4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66974, 1895, 236, 6, 65, "Code",ExpressionUUID->"c56fd884-dad4-4888-b17b-f81e5e853a07"],
Cell[67213, 1903, 150, 3, 41, "Output",ExpressionUUID->"d4b8e1e9-6881-4e54-bc86-64bd701f4e2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67400, 1911, 226, 6, 65, "Code",ExpressionUUID->"3affcefd-55f2-41c9-bb30-11e5a6ef989c"],
Cell[67629, 1919, 222, 6, 41, "Output",ExpressionUUID->"6d954bb9-e27c-48cd-9a1a-4ffbed1b91a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67888, 1930, 209, 5, 65, "Code",ExpressionUUID->"8b5c94ac-2630-47bb-b361-e8f48fb77874"],
Cell[68100, 1937, 177, 4, 41, "Output",ExpressionUUID->"bf05b200-c877-4351-8cd9-580af1ee53e4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68338, 1948, 84, 0, 66, "Subsection",ExpressionUUID->"a72d23ba-3074-43e4-8ff4-5681f0f2b915"],
Cell[CellGroupData[{
Cell[68447, 1952, 93, 0, 54, "Subsubsection",ExpressionUUID->"9bd34e72-643e-45ad-b8a9-f6fb752e02f2"],
Cell[CellGroupData[{
Cell[68565, 1956, 413, 12, 65, "Code",ExpressionUUID->"068ae918-9902-4bf9-8d87-f1fe62a4d3b6"],
Cell[68981, 1970, 1294, 38, 67, "Output",ExpressionUUID->"f671b0d2-3b53-4274-83ce-8eb882617b0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70312, 2013, 387, 11, 65, "Code",ExpressionUUID->"8d2eea1f-dd82-4d2d-a669-4f6df8484a6b"],
Cell[70702, 2026, 1033, 31, 67, "Output",ExpressionUUID->"bb9ab83d-26f7-483e-8d91-c4947625e140"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71772, 2062, 386, 11, 65, "Code",ExpressionUUID->"e431a95e-dc21-4f74-a710-aa3b2e1018ea"],
Cell[72161, 2075, 1455, 44, 67, "Output",ExpressionUUID->"f97899d6-a04a-4215-9806-0e7de8ac07d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73653, 2124, 390, 11, 65, "Code",ExpressionUUID->"8f455cc3-ef15-4283-bd0a-acfb271849f1"],
Cell[74046, 2137, 1533, 44, 67, "Output",ExpressionUUID->"b0cd9eea-cd8e-4c62-92bd-a174a0e1762d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75616, 2186, 390, 11, 65, "Code",ExpressionUUID->"a2d609d3-84a4-4a28-bc8e-728cbca9db16"],
Cell[76009, 2199, 1455, 44, 67, "Output",ExpressionUUID->"863c2efe-9b11-47d9-94c2-9484f7561d5c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77513, 2249, 94, 0, 54, "Subsubsection",ExpressionUUID->"e84dfe81-09b4-4c51-b328-279b92b70f7b"],
Cell[CellGroupData[{
Cell[77632, 2253, 232, 6, 65, "Code",ExpressionUUID->"34252dc3-e7ac-4f44-9be6-ad0210774f51"],
Cell[77867, 2261, 6899, 138, 74, "Output",ExpressionUUID->"616fe989-d148-41c2-b27a-045cda25582b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84803, 2404, 228, 6, 65, "Code",ExpressionUUID->"2e8511d3-2509-4f86-85a3-2d7ec01ae78b"],
Cell[85034, 2412, 6868, 138, 74, "Output",ExpressionUUID->"9a16f0b9-e1da-4c2e-a010-6161acfac4c0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

